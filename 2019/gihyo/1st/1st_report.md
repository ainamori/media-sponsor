# PyCon JPとは

PyCon JPは日本国内外のPythonユーザーが一堂に会し、互いに交流を深め、知識を分け合い、新たな可能性を見つけられる場所として毎年9月中旬に開催されるカンファレンスです。

PyCon JP 2019は2019年9月14日にHENNGE株式会社で行われたスプリントから始まり、9月15日チュートリアルと9月16日〜17日のカンファレンスを大田区産業プラザPiOで行いました。来場者は4日間で約1160人と大盛況でした。ご参加いただいた皆様、本当にありがとうございました。

ここでは16〜17日に行われたカンファレンスのなかから、選りすぐりの注目セッションやイベントをレポートしていきます。

# 1日目基調講演

@ussy

![写真タイトル](./_static/hogehuga.jpg)

### 資料リンク

* [動画]()
* [スライド]()

# ビギナーズセッション 「Python開発を円滑に進めるためのツール設定」- Atsushi Odagiri

(横山直敬)

Atsushi Odagiri氏によるビギナーズセッション「Python開発を円滑に進めるためのツール設定」をレポートします。

ビギナーズセッションとは、Pythonの初心者が次のステップに踏み出すきっかけづくりを提供するセッションです。

"Python開発を円滑に進める"と聞いてどのようなイメージを持つでしょうか？小田切氏は「Python開発を円滑に進める」とはつまらないミスを減らすことにあると言います。
ツールは開発速度ではなく品質を上げる目的で使われます。ツールを実行するだけで今まで60%だった品質が80%にまで上がることもあるのです。


Python開発を支えるツールには大きく分けて3つの種類があります。

1. linterツール: コーディング規約に沿ったコードになっているかチェックするツール

    - 例. flake8, black

2. 型アノテーションツール: Pythonは動的型付け言語ですが、型アノテーションツールを使うことで変数や戻り値に想定外の型のデータが使われていないかチェックすることができます。

    - 例. mypy

3. テストツール: ユニットテストを実行するツール。複数のPythonバージョンを指定できるツールもある。

    - 例. pytest, tox
    

ビギナーセッションでは以下のツールの使い方・おすすめの設定が解説されました。

- flake8

- black

- mypy

- pytest

- tox

各ツールの使い方・設定の詳細についてはセッションの動画をご覧ください。

ツールはCI時に実行したり、Gitのpre-commitに設定してコミット前に実行することもできますが、最も望ましいのはエディタ上で自動実行することです。
コードの編集や保存時にツールからの警告が出たり、コードのフォーマットが自動に行われるように設定することができます。
エディタ上で自動実行されることの利点はツールからの警告をすぐにコードに反映できることにあります。
Visual Studio Code, emacs, vim, PyCharmといった主なエディタはツールの自動実行に対応しています。

特に設定しておくと良いのは、以下の3つです。

- 編集中のlinterツール(flake8やmypy)の警告を出す

- コードの保存と同時にblackでフォーマッティング

- テスト実行結果からエラー箇所へのジャンプ

退屈なこと(コーディング規約や型アノテーションのチェック)は機械(ツール)に任せることで、よりプログラムの本質に迫ったレビューや議論ができるようになります。その結果として開発全体が効率化されます。
また最後に小田切氏は、豊富なアドオンがあるテストツールpytestについて各自のプロジェクトに導入できそうなアドオンを調べてCIに導入してみることを提案しました。

![ビギナーズセッションを行う小田切氏](./_static/aodag_beginners_session.jpg)

- [動画](https://www.youtube.com/watch?v=1FcLwOpXuAI)

- [スライド](https://www.slideshare.net/aodag/python-172432039) 

# 1日目注目セッション「Djangoで実践ドメイン駆動設計による実装」 ー 大島和輝

(牛窪翔)

大島和輝氏による「Djangoで実践ドメイン駆動設計による実装」のセッションを紹介します。

株式会社パソナ JOB HUB 所属の大島和輝氏は[Django Congress JP 2019](https://djangocongress.jp/)のスタッフとしても活動された経験があり、Djangoに関するコミュニティに所属しつつ、精力的にアウトプットされている方です。

今回はドメイン駆動開発 (以下DDD) をDjangoでどう実装していくかの指針を紹介いただきました。

背景としては、複雑化してきたアプリケーションの開発で、ドメイン駆動設計の手法を一部取り入れた例が最近出てきました。 

アプリケーションの規模が増していくにつれて、MVCでの実装を続けていると、肥大化したModelやControllerが作られやすく、その解決策の一つとしてDDDの手法などが話題になっています。 

そこで、本セッションではDjangoでドメイン駆動開発(以下 DDD)を設計する際のやり方をDDDの用語を交えながら説明されました。

当日の説明にてまず最初に、DDD及びドメインとは何か、戦略的設計と戦術的設計の違い、MVCの問題点を紹介されました。

続いて、DDDの一手法であるクリーンアーキテクチャの説明とDjangoの説明を行いました。

最後に、Djangoのアプリケーション単位をサブドメインとしながら、DDDの

* ファクトリ

* ドメインサービス

* アプリケーションサービス

* エンティティ

* バリューオブジェクト

* リポジトリ

を中心にどのように実際に設計するのかソースコードを参照しながら紹介されました。

発表の中ではソースコードを参照しながら設計されています。セッション動画も是非御覧ください。

![DDDについて説明する大島氏](./_static/ooshima.jpg)

### 資料リンク

* [動画](https://www.youtube.com/watch?v=9-OIHTJdDew&t=530s)

# トークセッション（2）

@ussy

![写真タイトル](./_static/hogehuga.jpg)

### 資料リンク

* [動画]()
* [スライド]()

# 1日目注目セッション「Introduction to FEM Analysis with Python」ーTetsuo Koyama

（平尾 元紀）

Tetsuo Koyama氏による「Introduction to FEM Analysis with Python」の発表です。発表は英語で行われました。
FEM（finite element method、有限要素法）は複雑になってしまったPED（partial differential equations、偏微分方程式）に対して、近似解を得るための手法です。GetFEM++はFEMをPDEに適応するためのフレームワークを提供しています。Qhull、MUMPS、LAPACK/BLAS、Numpy/Scipyなど、数値計算に必要なライブラリも合わせて必要なようです。

コードと一緒にオブジェクトを扱う例を紹介していました。Mesher Object、Mesh Object、MeshFem Object、Model Objectと、それらに関連するいくつかのメソッドが紹介されました。
最後にLaplacian Brick, RHS and conditionを用いて数式を解き、グラフィカルな表示と検算を行うことの解説をされていました。

質問もいくつか出ており、この技術の応用例、その他の解析手法の利用、3Dモデルへの利用、解析を行うPCのスペックについて回答していました。

英語の発表ということで面白そうだけれども理解できるのか不安だったのですが、コード例や出力結果を用いた説明がわかりやすく、自分でもFEMを用いて解析したいと思える、良い発表でした。
プログラミングと合わせて、数学で求めることができるロジックについても勉強していきたいな、と思いました。

![Laplacian Brick, RHS and conditionを実演するTetsuo Koyama氏](./_static/TatsuoKoyama.jpg)

### 資料リンク

* [動画](https://www.youtube.com/watch?v=6JuB1GiDLQQ)
* [スライド](https://gitpitch.com/tkoyama010/OpenCAE-tkoyama010/PyConJP2019)

# 1日目注目セッション「Yet Another Isolation - Debian Packageと紐づく環境分離」 ー 末田卓巳 (Takumi SUEDA)

（nikkie）

末田卓巳氏による「Yet Another Isolation - Debian Packageと紐づく環境分離」をレポートします。

末田氏は GROOVE X 株式会社にてLOVOT（ラボット）の開発に携わっています。
LOVOTにはDebian Linuxが2台入っており、LOVOTにデプロイするソフトウェアはDebianパッケージにしてAPTでインストールしているそうです。
Python製のソフトウェアをAPTでインストールする際に、依存するPythonパッケージをどう扱うか、実務で培った知見を共有するトークでした。

まずは既存の方法についての共有がありました。
Pythonの環境分離方法にはvenvがあります。
フックを使うと、Debianパッケージのインストール・アンインストール時にスクリプトを実行できるため、インストール時にvenvを作るスクリプトを試したそうです。
venvで満たせた要件もありましたが、「システムの中のどこに、いくつ、誰がvenvを作ったのかはわからない」ことが懸念されました。
他のツールとして、pyenvでも懸念事項が残ったため、末田氏は環境分離ツールを自作することにしました。

早速作るのではなく、実現手法とコマンドの形式を整理します。

- 分離された環境を作る`create`コマンド
- 分離された環境を一覧表示する`list`コマンド
- 指定した環境を削除する`purge`コマンド
- 指定した環境でコマンドを実行する`run`コマンド
- 指定した環境の中の実行ファイルのパスを表示する`which`コマンド

いよいよ実装です。
その中の1つ`run`コマンドの実装方法について、ここで取り上げます。
標準モジュール`subprocess`の`run`メソッドを使うと、Pythonの子プロセスとして別のプログラムを実行できます。
一方、シバン（Shebang）で使われる`env`コマンドから別のプログラムを実行した場合、`env`コマンドはプロセスツリーから消えます。
末田氏は`env`コマンドに倣った挙動としたかったため、標準モジュール`os`の`execv`メソッドを使って実装しました。
`os.execv`を使うとプロセスツリーからPythonが消えることは、対話モードでPythonを立ち上げて確認できます。

```shell
$ python3  # macOS 10.14.4で検証
Python 3.7.3 (v3.7.3:ef4ec6ed12, Mar 25 2019, 16:52:21)
>>> import os
>>> os.execv('/usr/bin/vim', ['vim'])  # vimを起動
# vimが起動する。:qで終了する
$ # 対話モードではなく、シェルに戻る（vimはPythonの子プロセスとして起動されていなかった）
```

本発表は自作した環境分離ツールについての発表ですが、Pythonでほしいツールを自作する際の方法も学べるトークだったと考えています。
いきなり実装するのではなく、コマンドの形式を整理する姿勢を真似することで、私たちがツールを自作する際も開発が円滑に進みそうです。
スライドは見やすく、話もうまく、1つの手本と感じたトークでした。

![冒頭、LOVOTの構成について紹介する末田氏](./_static/suedashi_lovot.jpg)

### 資料リンク

* [動画](https://www.youtube.com/watch?v=e9MKpn8bqx4)
* [スライド](https://speakerdeck.com/puhitaku/yet-another-isolation-debian-packagetoniu-dukuhuan-jing-fen-li)
* 取り上げられた環境分離ツールgxenv [PyPI](https://pypi.org/project/gxenv/)、[GitHub](https://github.com/groove-x/gxenv)

# 1日目ライトニングトーク

PyCon JP 2019では、1日目、2日目ともにクロージングでライトニングトークを行いました。1日目はスポンサー企業を含め7枠の発表があり、その中から2つピックアップしてご紹介します。

## 1つ目タイトル

@ussy

![写真タイトル](./_static/hogehuga.jpg)


## 「『ありがとう』と言おう」 ー イクバル・アバドゥラ

（nikkie）

PyCon JPの立ち上げメンバー、イクバル氏による、OSSへの感謝の伝え方を扱ったライトニングトークです。

私たちはみんなオープンソースソフトウェア（OSS）を使っていると話し始めたイクバル氏。
人が80歳まで生きるとすると、自由時間は9年間くらい（11%）だそうです。
OSSは誰かの自由時間で生み出されており、私たちは**誰かの自由時間から生み出された便利さ**を享受しているわけです。

2014年にあるOSSで、1000万サイトのセキュリティが、燃え尽き寸前の1人のエンジニアの肩にかかっていたという事態が発生しました。
こういった問題について「誰かがやってくれるだろう」と考えがちですが、イクバル氏は**私たちの問題と考えることが必要**と語ります。

そして、個人と企業それぞれができる、OSSに「ありがとう」と言う行動を紹介していきます。
個人の場合は、「ありがとうメールやチョコを送る」「ドキュメンテーションを整備する」「プルリクエストを送ってみる」など。
「PyCon JPのスタッフをボランティアでやる」ことも1つの感謝の伝え方だそうです。
企業では、「OSSに寄付をする」「メンテナを雇って開発を支える」そして「そういう活動をしていることを世に発信する」という行動が取れるそうです。
そして「PyCon JP、いつもありがとう」とLTを締めくくりました。

思うにこのトークの効果で、1日目のパーティーで私はいろいろな方から「スタッフお疲れさまでした。ありがとうございます」という言葉をいただきました。
PyCon JPというスタッフ活動のゴールの場で、参加者の方に労っていただけるのは、スタッフ冥利に尽きます。

私はOSS活動は無理のない範囲で取り組むのが最重要だと思っています。
このLTを聞いて、自分も感謝を伝えたいと思った方は、小さい一歩から始めてみてはいかがでしょうか。

![OSSの燃え尽きは私たちの問題と指摘するイクバル氏](./_static/iqbal_lt_thank_you.jpg)


## 1日目ライトニングトーク一覧

@ussy

今回ご紹介しきれなかったものも含め、1日目のライトニングトークの一覧はこちらです。また、Pythonの公式アカウントに[ライトニングトークの動画]()がアップロードされています。



# 次回は

@nikkie

1日目のカンファレンスレポートは以上です。今回紹介できなかったセッションも多数あるのですが、それらは下記のリンクから見ることができます。みなさまの気になるセッションやトークは見つかりましたか？

* [Youtube PyCon JP公式アカウント](https://www.youtube.com/channel/UCxNoKygeZIE1AwZ_NdUCkhQ)

2日目のレポートも後日、公開しますので楽しみにしてください！
